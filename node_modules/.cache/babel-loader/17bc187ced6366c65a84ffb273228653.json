{"ast":null,"code":"import { Key } from '../../../../types.js';\nimport React$1, { PureComponent, createRef, Children } from 'react';\nimport { ThemeProvider as ThemeProvider$1 } from '../../../ThemeProvider/ThemeProvider.js';\nimport { EventListener as EventListener$1 } from '../../../EventListener/EventListener.js';\nimport { durationBase } from '@shopify/polaris-tokens';\nimport { overlay } from '../../../shared.js';\nimport { classNames } from '../../../../utilities/css.js';\nimport { findFirstFocusableNode } from '../../../../utilities/focus.js';\nimport { isElementOfType, wrapWithComponent } from '../../../../utilities/components.js';\nimport styles from '../../Popover.scss.js';\nimport { Pane as Pane$1 } from '../Pane/Pane.js';\nimport { KeypressListener as KeypressListener$1 } from '../../../KeypressListener/KeypressListener.js';\nimport { PositionedOverlay as PositionedOverlay$1 } from '../../../PositionedOverlay/PositionedOverlay.js';\nlet PopoverCloseSource;\n\n(function (PopoverCloseSource) {\n  PopoverCloseSource[PopoverCloseSource[\"Click\"] = 0] = \"Click\";\n  PopoverCloseSource[PopoverCloseSource[\"EscapeKeypress\"] = 1] = \"EscapeKeypress\";\n  PopoverCloseSource[PopoverCloseSource[\"FocusOut\"] = 2] = \"FocusOut\";\n  PopoverCloseSource[PopoverCloseSource[\"ScrollOut\"] = 3] = \"ScrollOut\";\n})(PopoverCloseSource || (PopoverCloseSource = {}));\n\nvar TransitionStatus;\n\n(function (TransitionStatus) {\n  TransitionStatus[\"Entering\"] = \"entering\";\n  TransitionStatus[\"Entered\"] = \"entered\";\n  TransitionStatus[\"Exiting\"] = \"exiting\";\n  TransitionStatus[\"Exited\"] = \"exited\";\n})(TransitionStatus || (TransitionStatus = {}));\n\nclass PopoverOverlay extends PureComponent {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      transitionStatus: this.props.active ? TransitionStatus.Entering : TransitionStatus.Exited\n    };\n    this.contentNode = /*#__PURE__*/createRef();\n    this.enteringTimer = void 0;\n    this.exitingTimer = void 0;\n\n    this.renderPopover = overlayDetails => {\n      const {\n        measuring,\n        desiredHeight,\n        positioning\n      } = overlayDetails;\n      const {\n        id,\n        children,\n        sectioned,\n        fullWidth,\n        fullHeight,\n        fluidContent,\n        hideOnPrint,\n        colorScheme,\n        autofocusTarget\n      } = this.props;\n      const className = classNames(styles.Popover, positioning === 'above' && styles.positionedAbove, fullWidth && styles.fullWidth, measuring && styles.measuring, hideOnPrint && styles['PopoverOverlay-hideOnPrint']);\n      const contentStyles = measuring ? undefined : {\n        height: desiredHeight\n      };\n      const contentClassNames = classNames(styles.Content, fullHeight && styles['Content-fullHeight'], fluidContent && styles['Content-fluidContent']);\n      const content = /*#__PURE__*/React$1.createElement(\"div\", {\n        id: id,\n        tabIndex: autofocusTarget === 'none' ? undefined : -1,\n        className: contentClassNames,\n        style: contentStyles,\n        ref: this.contentNode\n      }, renderPopoverContent(children, {\n        sectioned\n      }));\n      return /*#__PURE__*/React$1.createElement(\"div\", Object.assign({\n        className: className\n      }, overlay.props), /*#__PURE__*/React$1.createElement(EventListener$1, {\n        event: \"click\",\n        handler: this.handleClick\n      }), /*#__PURE__*/React$1.createElement(EventListener$1, {\n        event: \"touchstart\",\n        handler: this.handleClick\n      }), /*#__PURE__*/React$1.createElement(KeypressListener$1, {\n        keyCode: Key.Escape,\n        handler: this.handleEscape\n      }), /*#__PURE__*/React$1.createElement(\"div\", {\n        className: styles.FocusTracker // eslint-disable-next-line jsx-a11y/no-noninteractive-tabindex\n        ,\n        tabIndex: 0,\n        onFocus: this.handleFocusFirstItem\n      }), /*#__PURE__*/React$1.createElement(ThemeProvider$1, {\n        alwaysRenderCustomProperties: true,\n        theme: {\n          colorScheme\n        }\n      }, /*#__PURE__*/React$1.createElement(\"div\", {\n        className: styles.Wrapper\n      }, content)), /*#__PURE__*/React$1.createElement(\"div\", {\n        className: styles.FocusTracker // eslint-disable-next-line jsx-a11y/no-noninteractive-tabindex\n        ,\n        tabIndex: 0,\n        onFocus: this.handleFocusLastItem\n      }));\n    };\n\n    this.handleClick = event => {\n      const target = event.target;\n      const {\n        contentNode,\n        props: {\n          activator,\n          onClose\n        }\n      } = this;\n      const isDescendant = contentNode.current != null && nodeContainsDescendant(contentNode.current, target);\n      const isActivatorDescendant = nodeContainsDescendant(activator, target);\n\n      if (isDescendant || isActivatorDescendant || this.state.transitionStatus !== TransitionStatus.Entered) {\n        return;\n      }\n\n      onClose(PopoverCloseSource.Click);\n    };\n\n    this.handleScrollOut = () => {\n      this.props.onClose(PopoverCloseSource.ScrollOut);\n    };\n\n    this.handleEscape = () => {\n      this.props.onClose(PopoverCloseSource.EscapeKeypress);\n    };\n\n    this.handleFocusFirstItem = () => {\n      this.props.onClose(PopoverCloseSource.FocusOut);\n    };\n\n    this.handleFocusLastItem = () => {\n      this.props.onClose(PopoverCloseSource.FocusOut);\n    };\n  }\n\n  changeTransitionStatus(transitionStatus, cb) {\n    this.setState({\n      transitionStatus\n    }, cb); // Forcing a reflow to enable the animation\n\n    this.contentNode.current && this.contentNode.current.getBoundingClientRect();\n  }\n\n  componentDidMount() {\n    if (this.props.active) {\n      this.focusContent();\n      this.changeTransitionStatus(TransitionStatus.Entered);\n    }\n  }\n\n  componentDidUpdate(oldProps) {\n    if (this.props.active && !oldProps.active) {\n      this.focusContent();\n      this.changeTransitionStatus(TransitionStatus.Entering, () => {\n        this.clearTransitionTimeout();\n        this.enteringTimer = window.setTimeout(() => {\n          this.setState({\n            transitionStatus: TransitionStatus.Entered\n          });\n        }, durationBase);\n      });\n    }\n\n    if (!this.props.active && oldProps.active) {\n      this.changeTransitionStatus(TransitionStatus.Exiting, () => {\n        this.clearTransitionTimeout();\n        this.exitingTimer = window.setTimeout(() => {\n          this.setState({\n            transitionStatus: TransitionStatus.Exited\n          });\n        }, durationBase);\n      });\n    }\n  }\n\n  componentWillUnmount() {\n    this.clearTransitionTimeout();\n  }\n\n  render() {\n    const {\n      active,\n      activator,\n      fullWidth,\n      preferredPosition = 'below',\n      preferredAlignment = 'center',\n      preferInputActivator = true,\n      fixed,\n      zIndexOverride\n    } = this.props;\n    const {\n      transitionStatus\n    } = this.state;\n    if (transitionStatus === TransitionStatus.Exited && !active) return null;\n    const className = classNames(styles.PopoverOverlay, transitionStatus === TransitionStatus.Entering && styles['PopoverOverlay-entering'], transitionStatus === TransitionStatus.Entered && styles['PopoverOverlay-open'], transitionStatus === TransitionStatus.Exiting && styles['PopoverOverlay-exiting']);\n    return /*#__PURE__*/React$1.createElement(PositionedOverlay$1, {\n      fullWidth: fullWidth,\n      active: active,\n      activator: activator,\n      preferInputActivator: preferInputActivator,\n      preferredPosition: preferredPosition,\n      preferredAlignment: preferredAlignment,\n      render: this.renderPopover.bind(this),\n      fixed: fixed,\n      onScrollOut: this.handleScrollOut,\n      classNames: className,\n      zIndexOverride: zIndexOverride\n    });\n  }\n\n  clearTransitionTimeout() {\n    if (this.enteringTimer) {\n      window.clearTimeout(this.enteringTimer);\n    }\n\n    if (this.exitingTimer) {\n      window.clearTimeout(this.exitingTimer);\n    }\n  }\n\n  focusContent() {\n    const {\n      autofocusTarget = 'container'\n    } = this.props;\n\n    if (autofocusTarget === 'none' || this.contentNode == null) {\n      return;\n    }\n\n    requestAnimationFrame(() => {\n      if (this.contentNode.current == null) {\n        return;\n      }\n\n      const focusableChild = findFirstFocusableNode(this.contentNode.current);\n\n      if (focusableChild && autofocusTarget === 'first-node') {\n        focusableChild.focus({\n          preventScroll: process.env.NODE_ENV === 'development'\n        });\n      } else {\n        this.contentNode.current.focus({\n          preventScroll: process.env.NODE_ENV === 'development'\n        });\n      }\n    });\n  } // eslint-disable-next-line @shopify/react-no-multiple-render-methods\n\n\n}\n\nfunction renderPopoverContent(children, props) {\n  const childrenArray = Children.toArray(children);\n\n  if (isElementOfType(childrenArray[0], Pane$1)) {\n    return childrenArray;\n  }\n\n  return wrapWithComponent(childrenArray, Pane$1, props);\n}\n\nfunction nodeContainsDescendant(rootNode, descendant) {\n  if (rootNode === descendant) {\n    return true;\n  }\n\n  let parent = descendant.parentNode;\n\n  while (parent != null) {\n    if (parent === rootNode) {\n      return true;\n    }\n\n    parent = parent.parentNode;\n  }\n\n  return false;\n}\n\nexport { PopoverCloseSource, PopoverOverlay, nodeContainsDescendant };","map":{"version":3,"sources":["/Users/yewonkwak/Documents/GitHub/spacestagram/node_modules/@shopify/polaris/dist/esm/components/Popover/components/PopoverOverlay/PopoverOverlay.js"],"names":["Key","React$1","PureComponent","createRef","Children","ThemeProvider","ThemeProvider$1","EventListener","EventListener$1","durationBase","overlay","classNames","findFirstFocusableNode","isElementOfType","wrapWithComponent","styles","Pane","Pane$1","KeypressListener","KeypressListener$1","PositionedOverlay","PositionedOverlay$1","PopoverCloseSource","TransitionStatus","PopoverOverlay","constructor","state","transitionStatus","props","active","Entering","Exited","contentNode","enteringTimer","exitingTimer","renderPopover","overlayDetails","measuring","desiredHeight","positioning","id","children","sectioned","fullWidth","fullHeight","fluidContent","hideOnPrint","colorScheme","autofocusTarget","className","Popover","positionedAbove","contentStyles","undefined","height","contentClassNames","Content","content","createElement","tabIndex","style","ref","renderPopoverContent","Object","assign","event","handler","handleClick","keyCode","Escape","handleEscape","FocusTracker","onFocus","handleFocusFirstItem","alwaysRenderCustomProperties","theme","Wrapper","handleFocusLastItem","target","activator","onClose","isDescendant","current","nodeContainsDescendant","isActivatorDescendant","Entered","Click","handleScrollOut","ScrollOut","EscapeKeypress","FocusOut","changeTransitionStatus","cb","setState","getBoundingClientRect","componentDidMount","focusContent","componentDidUpdate","oldProps","clearTransitionTimeout","window","setTimeout","Exiting","componentWillUnmount","render","preferredPosition","preferredAlignment","preferInputActivator","fixed","zIndexOverride","bind","onScrollOut","clearTimeout","requestAnimationFrame","focusableChild","focus","preventScroll","process","env","NODE_ENV","childrenArray","toArray","rootNode","descendant","parent","parentNode"],"mappings":"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","sourcesContent":["import { Key } from '../../../../types.js';\nimport React$1, { PureComponent, createRef, Children } from 'react';\nimport { ThemeProvider as ThemeProvider$1 } from '../../../ThemeProvider/ThemeProvider.js';\nimport { EventListener as EventListener$1 } from '../../../EventListener/EventListener.js';\nimport { durationBase } from '@shopify/polaris-tokens';\nimport { overlay } from '../../../shared.js';\nimport { classNames } from '../../../../utilities/css.js';\nimport { findFirstFocusableNode } from '../../../../utilities/focus.js';\nimport { isElementOfType, wrapWithComponent } from '../../../../utilities/components.js';\nimport styles from '../../Popover.scss.js';\nimport { Pane as Pane$1 } from '../Pane/Pane.js';\nimport { KeypressListener as KeypressListener$1 } from '../../../KeypressListener/KeypressListener.js';\nimport { PositionedOverlay as PositionedOverlay$1 } from '../../../PositionedOverlay/PositionedOverlay.js';\n\nlet PopoverCloseSource;\n\n(function (PopoverCloseSource) {\n  PopoverCloseSource[PopoverCloseSource[\"Click\"] = 0] = \"Click\";\n  PopoverCloseSource[PopoverCloseSource[\"EscapeKeypress\"] = 1] = \"EscapeKeypress\";\n  PopoverCloseSource[PopoverCloseSource[\"FocusOut\"] = 2] = \"FocusOut\";\n  PopoverCloseSource[PopoverCloseSource[\"ScrollOut\"] = 3] = \"ScrollOut\";\n})(PopoverCloseSource || (PopoverCloseSource = {}));\n\nvar TransitionStatus;\n\n(function (TransitionStatus) {\n  TransitionStatus[\"Entering\"] = \"entering\";\n  TransitionStatus[\"Entered\"] = \"entered\";\n  TransitionStatus[\"Exiting\"] = \"exiting\";\n  TransitionStatus[\"Exited\"] = \"exited\";\n})(TransitionStatus || (TransitionStatus = {}));\n\nclass PopoverOverlay extends PureComponent {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      transitionStatus: this.props.active ? TransitionStatus.Entering : TransitionStatus.Exited\n    };\n    this.contentNode = /*#__PURE__*/createRef();\n    this.enteringTimer = void 0;\n    this.exitingTimer = void 0;\n\n    this.renderPopover = overlayDetails => {\n      const {\n        measuring,\n        desiredHeight,\n        positioning\n      } = overlayDetails;\n      const {\n        id,\n        children,\n        sectioned,\n        fullWidth,\n        fullHeight,\n        fluidContent,\n        hideOnPrint,\n        colorScheme,\n        autofocusTarget\n      } = this.props;\n      const className = classNames(styles.Popover, positioning === 'above' && styles.positionedAbove, fullWidth && styles.fullWidth, measuring && styles.measuring, hideOnPrint && styles['PopoverOverlay-hideOnPrint']);\n      const contentStyles = measuring ? undefined : {\n        height: desiredHeight\n      };\n      const contentClassNames = classNames(styles.Content, fullHeight && styles['Content-fullHeight'], fluidContent && styles['Content-fluidContent']);\n      const content = /*#__PURE__*/React$1.createElement(\"div\", {\n        id: id,\n        tabIndex: autofocusTarget === 'none' ? undefined : -1,\n        className: contentClassNames,\n        style: contentStyles,\n        ref: this.contentNode\n      }, renderPopoverContent(children, {\n        sectioned\n      }));\n      return /*#__PURE__*/React$1.createElement(\"div\", Object.assign({\n        className: className\n      }, overlay.props), /*#__PURE__*/React$1.createElement(EventListener$1, {\n        event: \"click\",\n        handler: this.handleClick\n      }), /*#__PURE__*/React$1.createElement(EventListener$1, {\n        event: \"touchstart\",\n        handler: this.handleClick\n      }), /*#__PURE__*/React$1.createElement(KeypressListener$1, {\n        keyCode: Key.Escape,\n        handler: this.handleEscape\n      }), /*#__PURE__*/React$1.createElement(\"div\", {\n        className: styles.FocusTracker // eslint-disable-next-line jsx-a11y/no-noninteractive-tabindex\n        ,\n        tabIndex: 0,\n        onFocus: this.handleFocusFirstItem\n      }), /*#__PURE__*/React$1.createElement(ThemeProvider$1, {\n        alwaysRenderCustomProperties: true,\n        theme: {\n          colorScheme\n        }\n      }, /*#__PURE__*/React$1.createElement(\"div\", {\n        className: styles.Wrapper\n      }, content)), /*#__PURE__*/React$1.createElement(\"div\", {\n        className: styles.FocusTracker // eslint-disable-next-line jsx-a11y/no-noninteractive-tabindex\n        ,\n        tabIndex: 0,\n        onFocus: this.handleFocusLastItem\n      }));\n    };\n\n    this.handleClick = event => {\n      const target = event.target;\n      const {\n        contentNode,\n        props: {\n          activator,\n          onClose\n        }\n      } = this;\n      const isDescendant = contentNode.current != null && nodeContainsDescendant(contentNode.current, target);\n      const isActivatorDescendant = nodeContainsDescendant(activator, target);\n\n      if (isDescendant || isActivatorDescendant || this.state.transitionStatus !== TransitionStatus.Entered) {\n        return;\n      }\n\n      onClose(PopoverCloseSource.Click);\n    };\n\n    this.handleScrollOut = () => {\n      this.props.onClose(PopoverCloseSource.ScrollOut);\n    };\n\n    this.handleEscape = () => {\n      this.props.onClose(PopoverCloseSource.EscapeKeypress);\n    };\n\n    this.handleFocusFirstItem = () => {\n      this.props.onClose(PopoverCloseSource.FocusOut);\n    };\n\n    this.handleFocusLastItem = () => {\n      this.props.onClose(PopoverCloseSource.FocusOut);\n    };\n  }\n\n  changeTransitionStatus(transitionStatus, cb) {\n    this.setState({\n      transitionStatus\n    }, cb); // Forcing a reflow to enable the animation\n\n    this.contentNode.current && this.contentNode.current.getBoundingClientRect();\n  }\n\n  componentDidMount() {\n    if (this.props.active) {\n      this.focusContent();\n      this.changeTransitionStatus(TransitionStatus.Entered);\n    }\n  }\n\n  componentDidUpdate(oldProps) {\n    if (this.props.active && !oldProps.active) {\n      this.focusContent();\n      this.changeTransitionStatus(TransitionStatus.Entering, () => {\n        this.clearTransitionTimeout();\n        this.enteringTimer = window.setTimeout(() => {\n          this.setState({\n            transitionStatus: TransitionStatus.Entered\n          });\n        }, durationBase);\n      });\n    }\n\n    if (!this.props.active && oldProps.active) {\n      this.changeTransitionStatus(TransitionStatus.Exiting, () => {\n        this.clearTransitionTimeout();\n        this.exitingTimer = window.setTimeout(() => {\n          this.setState({\n            transitionStatus: TransitionStatus.Exited\n          });\n        }, durationBase);\n      });\n    }\n  }\n\n  componentWillUnmount() {\n    this.clearTransitionTimeout();\n  }\n\n  render() {\n    const {\n      active,\n      activator,\n      fullWidth,\n      preferredPosition = 'below',\n      preferredAlignment = 'center',\n      preferInputActivator = true,\n      fixed,\n      zIndexOverride\n    } = this.props;\n    const {\n      transitionStatus\n    } = this.state;\n    if (transitionStatus === TransitionStatus.Exited && !active) return null;\n    const className = classNames(styles.PopoverOverlay, transitionStatus === TransitionStatus.Entering && styles['PopoverOverlay-entering'], transitionStatus === TransitionStatus.Entered && styles['PopoverOverlay-open'], transitionStatus === TransitionStatus.Exiting && styles['PopoverOverlay-exiting']);\n    return /*#__PURE__*/React$1.createElement(PositionedOverlay$1, {\n      fullWidth: fullWidth,\n      active: active,\n      activator: activator,\n      preferInputActivator: preferInputActivator,\n      preferredPosition: preferredPosition,\n      preferredAlignment: preferredAlignment,\n      render: this.renderPopover.bind(this),\n      fixed: fixed,\n      onScrollOut: this.handleScrollOut,\n      classNames: className,\n      zIndexOverride: zIndexOverride\n    });\n  }\n\n  clearTransitionTimeout() {\n    if (this.enteringTimer) {\n      window.clearTimeout(this.enteringTimer);\n    }\n\n    if (this.exitingTimer) {\n      window.clearTimeout(this.exitingTimer);\n    }\n  }\n\n  focusContent() {\n    const {\n      autofocusTarget = 'container'\n    } = this.props;\n\n    if (autofocusTarget === 'none' || this.contentNode == null) {\n      return;\n    }\n\n    requestAnimationFrame(() => {\n      if (this.contentNode.current == null) {\n        return;\n      }\n\n      const focusableChild = findFirstFocusableNode(this.contentNode.current);\n\n      if (focusableChild && autofocusTarget === 'first-node') {\n        focusableChild.focus({\n          preventScroll: process.env.NODE_ENV === 'development'\n        });\n      } else {\n        this.contentNode.current.focus({\n          preventScroll: process.env.NODE_ENV === 'development'\n        });\n      }\n    });\n  } // eslint-disable-next-line @shopify/react-no-multiple-render-methods\n\n\n}\n\nfunction renderPopoverContent(children, props) {\n  const childrenArray = Children.toArray(children);\n\n  if (isElementOfType(childrenArray[0], Pane$1)) {\n    return childrenArray;\n  }\n\n  return wrapWithComponent(childrenArray, Pane$1, props);\n}\n\nfunction nodeContainsDescendant(rootNode, descendant) {\n  if (rootNode === descendant) {\n    return true;\n  }\n\n  let parent = descendant.parentNode;\n\n  while (parent != null) {\n    if (parent === rootNode) {\n      return true;\n    }\n\n    parent = parent.parentNode;\n  }\n\n  return false;\n}\n\nexport { PopoverCloseSource, PopoverOverlay, nodeContainsDescendant };\n"]},"metadata":{},"sourceType":"module"}